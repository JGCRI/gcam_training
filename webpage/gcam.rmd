---
pagetitle: gcam_training
output: 
  html_document:
    toc: true
    toc_float: true
    toc_collapsed: true
    #toc_depth: 3
    #number_sections: false
    theme: cosmo
    #inverse: true
---

<div class="header_logo">
<img src="images/logo_gcims_white.png" style="float:right;height:30px; padding-top:10px;">
<img src="images/logo_pnnl_white.png" style="float:right;height:40px;">
</div>

<!-------------------------->
<!-------------------------->
# Key Links
<!-------------------------->
<!-------------------------->
<p align="center"> <img src="images/divider.png"></p>

<br>

```{r key links table, results = 'show', eval=TRUE, echo=FALSE, warning=FALSE, error = FALSE, message = FALSE}
library(kableExtra); library(dplyr)

data.frame(
  Description = c("Official Documentation",
                  "FAQs, issues and discussions"),
  Link = c("http://jgcri.github.io/gcam-doc/index.html",
           "https://github.com/JGCRI/gcam-core/discussions")) %>%
  kable("html", escape = FALSE) %>%
  kable_styling(bootstrap_options = c("bordered","striped", "hover", "condensed", "responsive")) %>%
  row_spec(0, background = "#2A2A2A", color = "white")
```

<br>

<!-------------------------->
<!-------------------------->
# Tutorials
<!-------------------------->
<!-------------------------->
<p align="center"> <img src="images/divider.png"></p>

<br>

## GCAM 5.4
***

```{r presentation links table, results = 'show', eval=TRUE, echo=FALSE, warning=FALSE, error = FALSE, message = FALSE}
library(kableExtra); library(dplyr)

dt_url <- c("https://github.com/JGCRI/gcam_training/blob/main/presentations/gcam5p4_overview.pdf",
            "https://github.com/JGCRI/gcam_training/blob/main/presentations/gcam5p4_walkthrough.pdf")

data.frame(
  File = c("gcam5p4_overview.pdf",
           "gcam5p4_walkthrough.pdf"),
  Description = c("GCAM 5.4 overview presentation",
                  "GCAM 5.4 walkthrough presentation")) %>%
  dplyr::mutate(Location = cell_spec(rep("Link",length(dt_url)),"html",link=dt_url)) %>%
  kable("html", escape = FALSE) %>%
  kable_styling(bootstrap_options = c("bordered","striped", "hover", "condensed", "responsive")) %>%
  row_spec(0, background = "#2A2A2A", color = "white")
```


<div class="video_box">
<figure>
  <figcaption>GCAM 5.4 Overview</figcaption>
  <iframe width="200" height="200" src="https://www.youtube.com/embed/13tBgM_JWXc?rel=0" frameborder="0" allowfullscreen></iframe>
</figure>
</div>


<div class="video_box">
<figure>
  <figcaption>What's new in GCAM 5.4?</figcaption>
  <iframe width="200" height="200" src="https://www.youtube.com/embed/SI61E7_VJ-E?rel=0" frameborder="0" allowfullscreen></iframe>
</figure>
</div>

<br>

<!-------------------------->
<!-------------------------->
# Scenario Adjustments
<!-------------------------->
<!-------------------------->
<p align="center"> <img src="images/divider.png"></p>

## Transport Mix - Shareweights
***

```{r shareweight files table, results = 'show', eval=TRUE, echo=FALSE, warning=FALSE, error = FALSE, message = FALSE}
library(kableExtra); library(dplyr)

dt_url <- c("https://github.com/JGCRI/gcam_training/blob/main/examples/subsector_shareweights_ref.csv",
            "https://github.com/JGCRI/gcam_training/blob/main/examples/transportation_Subregions_Thailand.xml",
            "https://github.com/JGCRI/gcam_training/blob/main/examples/freight_rail_0034_2040_lin.xml",
            "https://github.com/JGCRI/gcam_training/blob/main/examples/freight_road_55_2040_lin.xml")

data.frame(
  "Files Used" = c("subsector_shareweights_ref.csv",
           "transportation_Subregions_Thailand.xml",
           "freight_rail_0034_2040_lin.xml",
           "freight_road_55_2040_lin.xml"),
  Description = c("Reference shareweights from Model Interface",
              "Existing default xml",
              "Linear interpolation from default 2015 value (0.001342) to 0.0034 in 2040 for freight rail",
              "Linear interpolation from default 2015 value (1) to 0.55 in 2040 for freight road")) %>%
  dplyr::mutate(Location = cell_spec(rep("Link",length(dt_url)),"html",link=dt_url)) %>%
  kable("html", escape = FALSE, col.names = c("Files Used", "Description", "Link")) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive")) %>%
  row_spec(0, background = "#2A2A2A", color = "white")
```


<!-------------------------->
<!----------Goal------------>
<!-------------------------->

<div class="warning" style='background-color:#E1F4F5; border-left: solid #1f1f1f 4px; border-radius: 4px; padding:0.7em;'>
<span>
<h3 style='text-align:center; font-size:24px'>
<b>Goal</b>
</h3>

<p style='margin-left:1em;'>
The goal of this example is to create a GCAM scenario that represents Indonesia's plans to increase passenger rail infrastructure. Indonesia's plans include major intercity and urban railway projects and targets to increase railway shares in passenger and freight transport; however, in GCAM's reference scenario, the share of rail in passenger transport does not increase through the century. The goal is to represent the rail infrastructure projects by increasing passenger rail shares.

</p>
</span>
</div>

<br>


<!-------------------------->
<!--------Approach---------->
<!-------------------------->

<div class="warning" style='background-color:#fffae0; border-left: solid #1f1f1f 4px; border-radius: 4px; padding:0.7em;'>
<span>

<h3 style='text-align:center; font-size:24px'>
<b>Approach</b></h3>

<p style='margin-left:1em;'>
Since infrastructure development is a non-cost impact on rail transport, we can use shareweights to represent these impacts. For more information on shareweights and when it is and isn't appropriate to modify them, see [link to shareweights page]. 

Share weights are calibration parameters and not directly related to any "real-world" value, so it is usually necessary to test a range of share weight modifications to obtain the desired effect. From the Model Interface "transport subsector share-weights" query, we see that the passenger rail share weight in Indonesia is 0.004 for all future periods. To represent infrastructure development through mid-century, we could gradually increase the share weight to 0.01 in 2050 and then keep it constant from 2050 to 2100. 

</p>
</span>
</div>

<br>


<!-------------------------->
<!---GCAM Implementation---->
<!-------------------------->

<div class="warning" style='background-color:#F5E5E1; border-left: solid #1f1f1f 4px; border-radius: 4px; padding:0.7em;'>
<span>
<h3 style='text-align:center; font-size:24px'>
<b>GCAM Implementation</b>
</h3>

<p style='margin-left:1em;'>
1. Create a folder in the input directory eg. `./gcam-core/input/addons`.
2. Download the example xml file [pass_rail_shrwt_lin_2050_fixed_2100](https://github.com/JGCRI/gcam_training/blob/main/examples/pass_rail_shrwt_lin_2050_fixed_2100.xml) to the folder.
4. Adjust the following in the appropriate `tranSubsector` tag in the XML:
</p>

<ul style='margin-left:4em; text-align:left;'>
  <li>`share-weight` for year 2050</li>
  <li>The interpolation rule from 2015 to 2050 (linear)</li>
  <li>The interpolation rule from 2050 to 2100 (fixed)</li>
</ul>

<p style='margin-bottom:1em; margin-left:1em; text-align:center;'> 
<b>Example xml structure</b> 
<br>
<img src="images/adjust_transport_mix_shareweight_eg_xml_structure2.png">
<i>Note: The first interpolation rule must include delete="1" in order to override all of the previous (default) interpolation rules.</i>
</p>

<p style='margin-left:1em;'>
7. Save the xml and then point to it in your configuration file by adding the line: 
<p style='font-size:0.8em'>
`<Value name = "adjust_pass_rail_shrwt">../gcam-core/input/addons/pass_rail_shrwt_lin_2050_fixed_2100.xml</Value>`

</p>
</p>

</span>
</div>

<br>

## Electricity Mix - Subsidy or Tax
***

* **[example_adjust_electricity_constraint.xml](https://github.com/JGCRI/gcam_training/blob/main/examples/example_adjust_electricity_constraint_subsidy.xml)**
* Relevant official GCAM Documentation link: http://jgcri.github.io/gcam-doc/policies_examples.html

The electricity generation mix can also be adjusted by setting floors or ceilings using a subsidy or tax policy. Constraints are set for each year within the subsidy or tax policy, and the policy must be passed to each individual `subsector` and `stub-technology` that you want to adjust. A list of the `subsector` and `stub-technology` available can be found in `.gcam-core\input\gcamdata\inst\extdata\energy\A23.globaltech_eff.csv`.

- Subsidy Policy: With a subsidy policy, a constraint can be set that acts as a generation floor for a given technology or set of technologies; i.e. electricity generation for that technology or total generation for the set of technologies will be at least as high as the constraint. 
- Tax Policy: Setting a constraint with a tax policy will have the opposite effect, ensuring that total generation for a technology or set of technologies does not exceed the constraint. 
- `min-price`: Additionally, the `min-price` tag in the example xml  below represents the price below which GCAM will consider a market solved (0 by default). It is possible to force generation to exactly match the constraint values rather than setting floors or ceilings by setting min-price to a large negative value in each year (e.g., <min-price year=”2020”>-10000</min-price>)

<div class="warning" style='background-color:#fffae0; border-left: solid #1f1f1f 4px; border-radius: 4px; padding:0.7em;'>
<span>
<p style='text-align:center'>
<b>Steps</b></p>
<p style='margin-left:1em;'>
1. Create a folder in the input directory eg. `./gcam-core/input/addons`.
2. Download the example xml file [example_adjust_electricity_constraint.xml](https://github.com/JGCRI/gcam_training/blob/main/examples/example_adjust_electricity_constraint_subsidy.xml) to the folder.
3. In the file change the `region`  and `market` from `Thailand` to whatever region you want to adjust the electricity mix for. 
4. Add a `policy-portfolio-standard name` for your chosen `subsector`
5. Adjust the `min-price` and the `constraint` for each year to the values desired.
6. Lower down in the file assign the corresponding `policy-portfolio-standard name` to each chosen `subsector`/`stub-technology`
7. Save the xml and then point to it in your configuration file by adding the line: 
<p style='font-size:0.8em'>`<Value name = "adjust_elec_mix_subsidy">../gcam-core/input/addons/example_adjust_electricity_constraint.xml</Value>`</p>
</p>
<p style='margin-bottom:1em; margin-left:1em; text-align:left; font-family:Georgia'> 
<b>Note: </b> 
<i>To use a `tax` policy repeat the steps but replace `subsidy` in the `<policyType>` argument in `./gcam-core/input/addons/example_adjust_electricity_constraint.xml` with `tax`.</i>
</p></span>
</div>

<br>

<!-------------------------->
# Batch runs
<!-------------------------->
<p align="center"> <img src="images/divider.png"></p>

<br>

<!-------------------------->
# Parallel runs
<!-------------------------->
<p align="center"> <img src="images/divider.png"></p>

<br>

<!-------------------------->
# gcamdata
<!-------------------------->
<p align="center"> <img src="images/divider.png"></p>

## Required packages and versions
***

renv.lock file and instrcutions on how to run to get the correct versions.

<br>

<!-------------------------->
# XMLs
<!-------------------------->
<p align="center"> <img src="images/divider.png"></p>

## Create XML from csv
***

<br>

<!-------------------------->
# Extracting GCAM data
<!-------------------------->
<p align="center"> <img src="images/divider.png"></p>

## rgcam
***

## modelInterface
***

## gcamextractor
***

## Argus
***

<!-------------------------->
# Git
<!-------------------------->
<p align="center"> <img src="images/divider.png"></p>

## From Stash(Bitbucket) to Github

This section discussed how to push a development branch of GCAM from stash onto github.

<div class="warning" style='background-color:#fffae0; border-left: solid #1f1f1f 4px; border-radius: 4px; padding:0.7em;'>
<span>
<p style='margin-top:1em; text-align:center'>
<b>From Stash to Github</b></p>
<p style='margin-left:1em;'>
1. Create a new repository in github: https://github.com/new
2. Give it a relevant name such as `gcam_v5p4_projectx`
3. Copy the clone address of the new repo e.g. https://github.com/USERNAME/gcam_v5p4_projectx.git
4. Push your local stash branch changes up to this branch: 
<p>`git push -u origin https://github.com/USERNAME/gcam_v5p4_projectx.git`</p>
5. Continue to work stash branch as usual and also push up latest changes to github as above.
</p></span>
</div>
